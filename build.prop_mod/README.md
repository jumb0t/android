# Modify Build Prop

Автоматическое изменение файлов `build.prop` на Android устройствах через ADB.

![Logo](https://example.com/logo.png) <!-- Замените на актуальное изображение, если необходимо -->

## Содержание

- [Описание](#описание)
- [Особенности](#особенности)
- [Требования](#требования)
- [Установка](#установка)
- [Использование](#использование)
  - [Запуск скрипта](#запуск-скрипта)
  - [Примеры запуска](#примеры-запуска)
- [Функционал](#функционал)
- [Логирование](#логирование)
- [Обработка ошибок](#обработка-ошибок)
- [Резервное копирование](#резервное-копирование)
- [Модификация файла `build.prop`](#модификация-файла-buildprop)
- [Поддержка](#поддержка)
- [Лицензия](#лицензия)

## Описание

`modify_build_prop.py` — это Python-скрипт, предназначенный для автоматического изменения файлов `build.prop` на Android устройствах через [ADB (Android Debug Bridge)](https://developer.android.com/studio/command-line/adb). Скрипт поддерживает работу с несколькими устройствами одновременно, обеспечивает создание резервных копий, модификацию содержимого файлов `build.prop` согласно заданным параметрам и загрузку изменённых файлов обратно на устройство. 

Основные возможности включают продвинутое логгирование с цветовой подсветкой, а также тщательную обработку исключений для обеспечения надёжности работы.

## Особенности

- **Поддержка нескольких устройств**: Возможность работы с несколькими подключёнными Android устройствами одновременно.
- **Резервное копирование**: Автоматическое создание резервных копий файлов `build.prop` перед внесением изменений.
- **Модификация свойств**: Обновление или добавление заданных свойств в файлы `build.prop`.
- **Логирование**: Продвинутое логирование с цветовой подсветкой для удобного отслеживания процесса.
- **Обработка ошибок**: Тщательная обработка исключений для предотвращения сбоев и обеспечения надёжности.

## Требования

Перед использованием скрипта убедитесь, что на вашей системе установлены следующие компоненты:

- **Python 3.6+**: Убедитесь, что Python версии 3.6 или выше установлен. [Скачать Python](https://www.python.org/downloads/)
- **ADB (Android Debug Bridge)**: Установите ADB и добавьте его в системный `PATH`. Инструкции по установке можно найти [здесь](https://developer.android.com/studio/command-line/adb#download).
- **Библиотека `colorama`**: Установите библиотеку `colorama` для цветовой подсветки в консоли.
  
  ```bash
  pip install colorama
  ```

## Установка

1. **Клонируйте репозиторий** или скачайте `modify_build_prop.py` напрямую.

   ```bash
   git clone https://github.com/yourusername/modify_build_prop.git
   cd modify_build_prop
   ```

2. **Установите зависимости**:

   Убедитесь, что у вас установлен `pip`, затем выполните:

   ```bash
   pip install -r requirements.txt
   ```

   Если `requirements.txt` отсутствует, установите `colorama` напрямую:

   ```bash
   pip install colorama
   ```

## Использование

### Запуск скрипта

Для запуска скрипта используйте команду:

```bash
python3 modify_build_prop.py
```

Убедитесь, что ADB запущен и ваше устройство подключено к компьютеру с включённым режимом отладки по USB.

### Примеры запуска

1. **Запуск без параметров**:

   Скрипт автоматически обнаружит подключённые устройства и предложит выбрать одно из них для обработки.

   ```bash
   python3 modify_build_prop.py
   ```

2. **Работа с несколькими устройствами**:

   Если подключено несколько устройств, скрипт отобразит список и попросит выбрать устройство по номеру.

   ```bash
   Обнаружено несколько устройств ADB:
   1. device_serial_1
   2. device_serial_2
   Выберите устройство по номеру (или 0 для выхода):
   ```

   Введите соответствующий номер и нажмите `Enter`.

## Функционал

### Основные компоненты скрипта

1. **Логирование**: Класс `Logger` отвечает за настройку и управление логированием. Логи выводятся как в консоль с цветовой подсветкой, так и в файл.

2. **Взаимодействие с ADB**: Класс `ADBHandler` предоставляет методы для выполнения команд ADB, управления подключёнными устройствами, копирования файлов и установки прав доступа.

3. **Модификация `build.prop`**: Класс `BuildPropModifier` отвечает за создание резервных копий, изменение содержимого файлов `build.prop` и их загрузку обратно на устройство.

4. **Выбор устройства**: Функция `select_device` позволяет пользователю выбрать одно из подключённых устройств для обработки.

5. **Главная функция**: Функция `main` связывает все компоненты вместе, обеспечивая полный процесс от обнаружения устройств до модификации файлов.

## Логирование

Скрипт использует модуль `logging` для записи логов как в консоль, так и в файл. Логи включают подробную информацию о процессе выполнения, что облегчает отладку и мониторинг.

- **Консоль**: Логи выводятся с цветовой подсветкой для различных уровней сообщений (INFO, WARNING, ERROR и т.д.).
- **Файл**: Все логи сохраняются в директории `build_prop_logs` с временной меткой, что позволяет отслеживать действия за определённый период.

**Пример лога в консоли**:

```
2024-10-19 12:00:00 INFO    - main       - modify_build_prop.py:250 - Запуск скрипта Modify Build Prop
2024-10-19 12:00:05 INFO    - process_device - modify_build_prop.py:180 - Начало обработки устройства device_serial_1...
...
```

## Обработка ошибок

Скрипт включает тщательную обработку исключений, что позволяет:

- **Предотвратить сбои**: В случае возникновения ошибки скрипт не завершится аварийно, а выдаст информативное сообщение об ошибке.
- **Логирование ошибок**: Все ошибки записываются в лог-файл с уровнем `ERROR` или `CRITICAL`, что облегчает диагностику проблем.
- **Безопасность данных**: В случае ошибки изменения файла `build.prop` резервная копия остаётся неизменной, предотвращая потенциальные проблемы с устройством.

## Резервное копирование

Перед внесением изменений скрипт автоматически создаёт резервные копии файлов `build.prop`. Резервные копии сохраняются в директории `build_prop_logs/{timestamp}/backups`, где `{timestamp}` — временная метка выполнения скрипта.

**Преимущества резервного копирования**:

- **Безопасность**: Возможность восстановить исходное состояние файла `build.prop` в случае непредвиденных ошибок.
- **История изменений**: Хранение исторических версий файлов для отслеживания внесённых изменений.

## Модификация файла `build.prop`

Скрипт модифицирует файлы `build.prop`, обновляя или добавляя заданные свойства. В конфигурации скрипта определены специфические свойства для различных путей `build.prop` и общие свойства, которые применяются ко всем файлам.

**Пример изменённых свойств**:

```properties
ro.product.vendor.brand=samsung
ro.product.vendor.device=beyond1
...
ro.build.fingerprint=samsung/beyond1lteeea/beyond1:12/SP1A.210812.016/G973FXXSGHWA3:user/release-keys
...
```

**Процесс модификации**:

1. **Чтение файла**: Скрипт читает содержимое локальной копии `build.prop`.
2. **Обновление свойств**: Существующие свойства обновляются новыми значениями, а новые свойства добавляются в файл.
3. **Запись изменений**: Изменённый файл записывается обратно на устройство через ADB.
4. **Установка прав**: Права доступа для файла `build.prop` устанавливаются на `644` для обеспечения корректной работы системы.

## Поддержка

Если у вас возникли вопросы или проблемы с использованием скрипта, вы можете связаться с нами:

- **Email**: support@example.com
- **GitHub Issues**: [Issues](https://github.com/yourusername/modify_build_prop/issues)
- **Telegram**: [@YourTelegram](https://t.me/yourtelegram)

Мы всегда готовы помочь и рады вашим отзывам!

## Лицензия

Этот проект лицензирован под лицензией [MIT License](LICENSE).

---

© 2024 OpenAI ChatGPT. Все права защищены.