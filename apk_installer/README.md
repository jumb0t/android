# F-Droid APK Installer

## Описание

**F-Droid APK Installer** — это Python-скрипт, который автоматически скачивает и устанавливает APK-файлы из репозитория [F-Droid](https://f-droid.org/) на подключённое устройство или эмулятор Android с помощью ADB (Android Debug Bridge).

## Возможности

- **Скачивание и парсинг `index.xml`**: Получение актуальной информации о доступных приложениях из репозитория F-Droid.
- **Извлечение актуальных URL-адресов APK**: Автоматическое определение последних версий APK-файлов для указанных пакетов.
- **Асинхронное скачивание с верификацией**: Быстрое скачивание APK-файлов с проверкой их целостности с помощью SHA256-хэша.
- **Установка APK через ADB**: Автоматическая установка скачанных APK-файлов на подключённое устройство или эмулятор Android.
- **Подробное логирование**: Ведение логов всех операций для упрощения отладки и мониторинга процесса установки.

## Предварительные требования

- **Python**: Версия 3.8 или выше.
- **ADB**: Установленный и добавленный в переменную окружения PATH. [Установка ADB](https://developer.android.com/studio/command-line/adb).
- **Python-пакеты**:
  - `aiohttp`
  - `aiofiles`
  - `lxml`
  - `tqdm`

## Установка

1. **Клонируйте репозиторий или скачайте скрипт:**

    ```bash
    git clone https://github.com/yourusername/fdroid-apk-installer.git
    cd fdroid-apk-installer
    ```

2. **Установите необходимые Python-пакеты:**

    ```bash
    pip install aiohttp aiofiles lxml tqdm
    ```

3. **Убедитесь, что ADB установлен и добавлен в PATH:**

    - Проверьте установку ADB:

        ```bash
        adb version
        ```

    - Если ADB не установлен, следуйте [официальной инструкции](https://developer.android.com/studio/command-line/adb) для установки.

## Использование

1. **Подготовьте устройство:**

    - Включите отладку по USB на вашем Android-устройстве.
    - Подключите устройство к компьютеру через USB или запустите эмулятор Android.

2. **Настройте список пакетов:**

    - В скрипте `fdroid_installer.py` в секции `PACKAGES` перечислите идентификаторы пакетов, которые вы хотите установить.

    ```python
    PACKAGES = [
        "org.fossify.clock",
        "org.fossify.keyboard",
        "org.fdroid.fdroid",
        # Добавьте другие пакеты по необходимости
    ]
    ```

3. **Запустите скрипт:**

    ```bash
    python3 fdroid_installer.py
    ```

    - Скрипт автоматически выполнит следующие шаги:
        1. Проверит наличие всех зависимостей.
        2. Определит подключённое устройство через ADB.
        3. Скачает и распарсит `index.xml` из F-Droid.
        4. Скачает необходимые APK-файлы с проверкой их целостности.
        5. Установит APK-файлы на устройство через ADB.
        6. Ведёт лог всех операций в директорию `./logs`.

## Конфигурация

В скрипте `fdroid_installer.py` доступны следующие параметры для настройки:

- **LOG_DIR**: Директория для хранения логов. По умолчанию `./logs`.
- **APK_DIR**: Директория для сохранения скачанных APK-файлов. По умолчанию `./fdroid_apks`.
- **FDROID_INDEX_URL**: URL для скачивания `index.xml` из F-Droid. По умолчанию `https://f-droid.org/repo/index.xml`.
- **MAX_DOWNLOAD_CONCURRENT**: Максимальное количество одновременных загрузок APK. По умолчанию `5`.
- **MAX_INSTALL_CONCURRENT**: Максимальное количество одновременных установок APK. По умолчанию `3`.
- **PACKAGES**: Список пакетов (идентификаторов), которые необходимо установить.

## Логирование

Все операции скрипта логируются как в файл, так и в консоль. Логи сохраняются в директории `./logs` с именем вида `install_fdroid_apps_YYYYMMDD_HHMMSS.log`. В логах содержится информация о процессе скачивания, проверки хэшей, установки APK и возможных ошибках.

## Обработка ошибок

Скрипт обрабатывает различные ошибки, включая:

- Отсутствие ADB или его неправильная настройка.
- Недоступность репозитория F-Droid или зеркал для скачивания APK.
- Ошибки при скачивании APK (например, неполный файл).
- Несоответствие хэш-суммы скачанного APK ожидаемой.
- Ошибки при установке APK на устройство через ADB.

При возникновении ошибок соответствующие сообщения записываются в лог и выводятся в консоль.

## Вклад

Если вы хотите внести свой вклад в развитие этого проекта, пожалуйста, создайте [issue](https://github.com/yourusername/fdroid-apk-installer/issues) или отправьте [pull request](https://github.com/yourusername/fdroid-apk-installer/pulls).

## Лицензия

Этот проект лицензирован под лицензией **GPL-3.0-only**. Подробнее см. в файле [LICENSE](LICENSE).

## Автор

**ChatGPT o1**

---

*Этот скрипт был создан с использованием возможностей модели ChatGPT от OpenAI.*

